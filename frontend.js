window.Webflow||=[],window.fsAttributes=window.fsAttributes||[];const jobPageUrl="lynkus.fr/offres-emplois",focusPageRootUrl="lynkus.fr/offre",apiURL="https://lynkus-api.netlify.app/.netlify/functions/fetchVacancies",homePageUrl="https://www.lynkus.fr/",prefix="data",prefixSlider="data-slider",regions=[{id:"1",name:"Auvergne-Rhone-Alpes",departements:["01","03","07","15","26","38","42","43","63","69","73","74",]},{id:"2",name:"Bourgogne-Franche-Comte",departements:["21","25","39","58","70","71","89","90"]},{id:"3",name:"Bretagne",departements:["22","29","35","56"]},{id:"4",name:"Centre-Val de Loire",departements:["18","28","36","37","41","45"]},{id:"5",name:"Corse",departements:["2A"]},{id:"6",name:"Grand Est",departements:["08","10","51","52","54","55","57","67","68","88",]},{id:"7",name:"Hauts-de-France",departements:["02","59","60","62","80"]},{id:"8",name:"Ile-de-France",departements:["75","77","78","91","92","93","94","95"]},{id:"9",name:"Normandie",departements:["14","27","50","61","76"]},{id:"10",name:"Nouvelle-Aquitaine",departements:["16","17","19","23","24","33","40","47","64","79","86","87",]},{id:"11",name:" Occitanie",departements:["09","11","12","30","31","32","34","46","48","65","66","81","82",]},{id:"12",name:"Pays de la Loire",departements:["44","49","53","72","85"]},{id:"13",name:"Provence-Alpes-Cote d Azur",departements:["04","05","06","13","83","84"]},{id:"14",name:"Guadeloupe",departements:["971"]},{id:"15",name:"Martinique",departements:["972"]},{id:"16",name:"Guyane",departements:["973"]},{id:"17",name:"Mayotte",departements:["976"]},],SELECTORS={title:`[${prefix}="title"]`,contract:`[${prefix}="contract"]`,town:`[${prefix}="town"]`,region:`[${prefix}="region"]`,postalCode:`[${prefix}="postalCode"]`,cpRegion:`[${prefix}="cpRegion"]`,metier:`[${prefix}="metier"]`,date:`[${prefix}="date"]`,dateNumber:`[${prefix}="date-us"]`,experience:`[${prefix}="experience"]`,experienceWrapper:`[${prefix}="exp-wrapper"]`,jobButton:`[${prefix}="button"]`,loader:`[${prefix}="loader"]`,locationFilter:`[${prefix}="location-filter"]`,contractFilter:`[${prefix}="contract-filter"]`,experienceFilter:`[${prefix}="exp-filter"]`,entreprise:`[${prefix}="entreprise"]`,profil:`[${prefix}="profil"]`,poste:`[${prefix}="poste"]`,sliderTitle:`[${prefixSlider}="title"]`,sliderContract:`[${prefixSlider}="contract"]`,sliderMetier:`[${prefixSlider}="metier"]`,sliderDate:`[${prefixSlider}="date"]`,sliderPostalCode:`[${prefixSlider}="postalCode"]`,sliderJobButton:`[${prefixSlider}="button"]`,sliderLoader:`[${prefix}="sliderLoader"]`},renderPostDom=(e,t)=>{e&&t?(e.innerText="",new DOMParser().parseFromString(t,"text/html").body.childNodes.forEach(t=>{e.append(t)})):hideElement(e.closest(".focus-content-wrapper"),!0)},enableCover=e=>{let t=getAttributeValue(e,"metier"),r=document.querySelector(`[data-cat="${t}"]`);hideElement(r,!1)},filterInternalJobs=(e,t)=>e.filter(e=>{let r=getAttributeValue(e,"offre_lynkus_interne");return t?"Oui"===r:"Oui"!==r}),getURLParams=e=>{let t=new URL(window.location.href);return new URLSearchParams(t.search).get(e)},hideElement=(e,t)=>{t?e.setAttribute("data-hidden","true"):e.removeAttribute("data-hidden")},formatDate=(e,t)=>{let r=new Date(e),i=r.getDate().toString().padStart(2,"0"),o=(r.getMonth()+1).toString().padStart(2,"0"),l=r.getFullYear().toString();return"fr"===t?`${i}/${o}/${l}`:`${l}${o}${i}`},getAttributeValue=(e,t)=>{let r=e.attributes.filter(e=>e.name.toString()==t.toString())[0];if(r&&r.value)return r.value},fetchOffers=async()=>{try{let e=await fetch("https://lynkus-api.netlify.app/.netlify/functions/fetchVacancies",{headers:{"Content-Type":"application/json; charset=utf-8"},method:"GET"});if(!e.ok)throw Error(`API request failed with status ${e.status}`);return await e.json()}catch(t){if(t instanceof SyntaxError)throw Error("Invalid JSON response from API");throw Error(`Failed to fetch speakers from API: ${t.message}`)}},populateAboutOffer=e=>{let t=document.querySelector(SELECTORS.title),r=document.querySelector(SELECTORS.contract),i=document.querySelector(SELECTORS.town),o=document.querySelector(SELECTORS.metier),l=document.querySelector(SELECTORS.date),n=document.querySelector(SELECTORS.entreprise),a=document.querySelector(SELECTORS.profil),s=document.querySelector(SELECTORS.poste),c=document.querySelector(SELECTORS.jobButton);t&&e.title?(t.innerText=e.title,document.title=`Offre d'emploi Lynkus : ${e.title}`,document.querySelector('meta[property="og:title"]').setAttribute("content",`Offre d'emploi Lynkus : ${e.title}`),document.querySelector('meta[property="twitter:title"]').setAttribute("content",`Offre d'emploi Lynkus : ${e.title}`)):hideElement(t.closest(".offre_desc-item"),!0),r&&e.contract_type_abbreviation?r.innerText=e.contract_type_abbreviation:hideElement(r.closest(".offre_desc-item"),!0),i&&e.town?i.innerText=e.town:hideElement(i.closest(".offre_desc-item"),!0);let d=getAttributeValue(e,"metier");if(d?(o.innerText=d,enableCover(e)):hideElement(o.closest(".offre_desc-item"),!0),l&&e.last_publication_date){let f=formatDate(e.last_publication_date,"fr");l.innerText=f}c&&e.apply_web_url&&(c.href=e.apply_web_url),renderPostDom(n,e.employer_description),renderPostDom(s,e.position_description),renderPostDom(a,e.profile_description)},createNewItem=(e,t)=>{let r=t.cloneNode(!0),i=r.querySelector(SELECTORS.title),o=r.querySelector(SELECTORS.contract),l=r.querySelector(SELECTORS.town),n=r.querySelector(SELECTORS.postalCode),a=r.querySelector(SELECTORS.metier),s=r.querySelector(SELECTORS.date),c=r.querySelector(SELECTORS.dateNumber),d=r.querySelector(SELECTORS.experience),f=r.querySelector(SELECTORS.region);r.querySelector(SELECTORS.cpRegion),r.querySelector(SELECTORS.jobButton).href=`https://${focusPageRootUrl}?id=${e.id}`,i&&e.title?i.innerText=e.title:i&&hideElement(i.closest(".content-wrapper"),!0),l&&e.town?l.innerText=e.town:l&&hideElement(l.closest(".offre_desc-item"),!0);let p=e=>{let t=e.slice(0,2);return"97"===t&&(t=e.slice(0,3)),regions.find(e=>e.departements.includes(t))};if(e.zipcode&&n){let u=e.zipcode;n.innerText=u;let m=p(e.zipcode);m&&f&&(f.innerText=m.name)}else f&&hideElement(f.closest(".offre_desc-item"),!0);o&&e.contract_type_name?e.contract_type_name:o&&hideElement(o.closest(".offre_desc-item"),!0);let S=getAttributeValue(e,"experience");d&&S?d.innerText=S:d&&hideElement(d.closest(".offre_desc-item"),!0);let y=getAttributeValue(e,"metier");if(a&&y?a.innerText=y:a&&hideElement(a.closest(".offre_desc-item"),!0),s&&e.last_publication_date){let E=formatDate(e.last_publication_date,"fr");s.innerText=E}if(c&&e.last_publication_date){let h=formatDate(e.last_publication_date,"us");c.innerText=h}return r},sliderInit=async e=>{let t=document.querySelector(SELECTORS.sliderLoader),r=document.querySelector(".home-offre-item").cloneNode(!0),i=document.querySelector(".layout-home-offre"),o={slidesToShow:2.65,slidesToScroll:1,autoplay:!1,infinite:!1,arrows:!0,nextArrow:'<button type="button" class="slick-next mobile-slider-arrow right"><svg width="10" height="17" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.50023 16.9998L0.0668945 15.5664L6.66689 8.96644L0.0668945 2.36644L1.50023 0.933105L9.53356 8.96644L1.50023 16.9998Z" fill="currentcolor"/></svg></button>',prevArrow:'<button type="button" class="slick-prev mobile-slider-arrow left"><svg width="10" height="17" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49977 16.9998L9.93311 15.5664L3.33311 8.96644L9.93311 2.36644L8.49977 0.933105L0.466439 8.96644L8.49977 16.9998Z" fill="currentcolor"/></svg></button>',responsive:[{breakpoint:1075,settings:{slidesToShow:2,speed:8e3}},{breakpoint:650,settings:{slidesToShow:1.15,slidesToScroll:1,autoplay:!1,infinite:!1}},]},l=await fetchOffers();i.innerHTML="";let n=filterInternalJobs(l,e);n.sort((e,t)=>new Date(t.last_publication_date)-new Date(e.last_publication_date));let a=0;n.map(e=>{a<5&&(createSliderItem(e,r,i),a++)}),$(".layout-home-offre").slick(o),t&&hideElement(t,!0)},nousRejoindreInit=async()=>{document.querySelector(SELECTORS.loader);let e=document.querySelector(".home-offre-item").cloneNode(!0),t=document.querySelector(".layout-home-offre .slick-track");t.innerHTML="";let r=await fetchOffers(),i=filterInternalJobs(r,"Non"),o=0;i.map(r=>{o<5&&(createSliderItem(r,e,t),o++)})},classicInit=async(e,t)=>{let r=document.querySelector(SELECTORS.loader),i=e[0],[o]=i.items,l=await fetchOffers(),n=filterInternalJobs(l,t),a=o.element;i.clearItems(),await i.addItems(n.map(e=>createNewItem(e,a))),document.querySelectorAll(".filter-row").forEach((e,t)=>{0!==t&&e.classList.remove("is-active")}),r&&hideElement(r,!0)},createSliderItem=(e,t,r)=>{let i=t.cloneNode(!0),o=i.querySelector(SELECTORS.sliderTitle),l=i.querySelector(SELECTORS.sliderContract),n=i.querySelector(SELECTORS.sliderMetier),a=i.querySelector(SELECTORS.sliderDate),s=i.querySelector(SELECTORS.sliderPostalCode);i.querySelector(SELECTORS.sliderJobButton).setAttribute("href",`https://${focusPageRootUrl}?id=${e.id}`),o&&(o.innerText=e.title),l&&(l.innerText=e.contract_type_abbreviation);let c=getAttributeValue(e,"metier");if(n&&(n.innerText=c),s&&(s.innerText=e.zipcode),a){let d=formatDate(e.last_publication_date,"fr");a.innerText=d}r.append(i)},focusOfferInit=async e=>{let t=document.querySelector(SELECTORS.loader);if(!e)return window.location.replace(`https://www.${jobPageUrl}`);let r=(await fetchOffers()).filter(t=>parseInt(t.id)===parseInt(e))[0];populateAboutOffer(r),t&&hideElement(t,!0)};window.Webflow.push(()=>{(async()=>{let e=document.URL,t=getURLParams("id");e.includes(jobPageUrl)?window.fsAttributes.push(["cmsload",async e=>{classicInit(e,!1)},]):"https://www.lynkus.fr/"===e?sliderInit(!1):e.includes(focusPageRootUrl)?(focusOfferInit(t),sliderInit(!1)):window.fsAttributes.push(["cmsload",async e=>{classicInit(e,!0)},]),sliderLoader&&hideElement(sliderLoader,!0)})()});